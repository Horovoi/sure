<%
  percentage = total.zero? ? 0 : (item[:total].to_f / total * 100).round(1)
  is_sub = level == :subcategory
%>

<div data-category="category-<%= item[:category_id] %>" class="grid grid-cols-[2fr_repeat(4,minmax(0,1fr))] items-center text-secondary text-sm py-3 px-4 lg:px-6">
  <div class="flex items-center gap-2 min-w-0 <%= is_sub ? "pl-3 lg:pl-3" : "" %>">
    <% if is_sub %>
      <div class="text-subdued">
        <%= icon "corner-down-right" %>
      </div>
    <% end %>
    <% if item[:category_icon] %>
      <div class="h-7 w-7 flex-shrink-0 rounded-full flex justify-center items-center"
        style="
          background-color: color-mix(in oklab, <%= item[:category_color] %> 10%, transparent);
          border-color: color-mix(in oklab, <%= item[:category_color] %> 10%, transparent);
          color: <%= item[:category_color] %>;
        ">
        <%= icon(item[:category_icon], color: "current", size: "sm") %>
      </div>
    <% else %>
      <%= render DS::FilledIcon.new(
        variant: :text,
        hex_color: item[:category_color],
        text: item[:category_name],
        size: "md",
        rounded: true
      ) %>
    <% end %>
    <span class="font-medium text-primary truncate">
      <%= item[:category_name] %>
    </span>
  </div>

  <div class="text-right">
    <span class="text-sm <%= color_class %>">
      <%= Money.new(item[:total], Current.family.currency).format %>
    </span>
  </div>

  <div class="text-right">
    <span class="text-sm text-tertiary">
      <%= item[:count] %>
    </span>
  </div>

  <div class="text-right">
    <span class="text-sm text-tertiary">
      <% if item[:count] > 1 %>
        <%= Money.new(item[:total] / item[:count], Current.family.currency).format %>
      <% else %>
        â€”
      <% end %>
    </span>
  </div>

  <div class="text-right">
    <span class="text-sm text-secondary">
      <%= percentage %>%
    </span>
  </div>
</div>
